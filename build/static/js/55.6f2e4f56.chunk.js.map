{"version":3,"sources":["routes/Login/service/index.js","routes/Login/model/index.js"],"names":["login","_x","_login","apply","this","arguments","_callee","payload","regenerator_default","a","wrap","_context","prev","next","abrupt","$$","post","stop","__webpack_exports__","namespace","state","loggedIn","message","user","subscriptions","setup","_ref","history","dispatch","listen","_ref2","pathname","indexOf","removeStore","effects","mark","_ref3","_ref4","call","put","_ref5","status","data","sent","setStore","routerRedux","replace","type","logout","_","_ref6","_context2","reducers","loginSuccess","_ref7","Object","objectSpread","loginError","_ref8"],"mappings":"iKAEO,SAAeA,EAAtBC,GAAA,OAAAC,EAAAC,MAAAC,KAAAC,sDAAO,SAAAC,EAAqBC,GAArB,OAAAC,EAAAC,EAAAC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAG,OAAA,SACEC,IAAGC,KAAK,cAAeT,IADzB,wBAAAI,EAAAM,SAAAX,6BCEQY,EAAA,SACbC,UAAW,QAEXC,MAAO,CACLC,UAAU,EACVC,QAAS,GACTC,KAAM,IAGRC,cAAe,CACbC,MADa,SAAAC,GACgB,IAArBC,EAAqBD,EAArBC,QAAqBD,EAAZE,SACf,OAAOD,EAAQE,OAAO,SAAAC,IACqB,IADHA,EAAfC,SACVC,QAAQ,gBACnBjB,IAAGkB,YAAY,YAMvBC,QAAS,CACNlC,MADMQ,EAAAC,EAAA0B,KAAA,SAAAnC,EAAAoC,EAAAC,GAAA,IAAA9B,EAAA+B,EAAAC,EAAAC,EAAAC,EAAAnB,EAAAoB,EAAA,OAAAlC,EAAAC,EAAAC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OAE6B,OAD3BN,EADF6B,EACE7B,QAAa+B,EADfD,EACeC,KAAMC,EADrBF,EACqBE,IADrB5B,EAAAE,KAAA,EAEmCyB,EAAKtC,EAAOO,GAF/C,UAAAiC,EAAA7B,EAAAgC,KAEGF,EAFHD,EAEGC,OAAQnB,EAFXkB,EAEWlB,QAASoB,EAFpBF,EAEoBE,MACrBD,EAHC,CAAA9B,EAAAE,KAAA,SAKH,OADAE,IAAG6B,SAAS,OAAQF,GAJjB/B,EAAAE,KAAA,GAKG0B,EAAIM,cAAYC,QAAQ,MAL3B,QAAAnC,EAAAE,KAAA,iBAOH,OAPGF,EAAAE,KAAA,GAOG0B,EAAI,CACRQ,KAAM,aACNxC,QAAS,CAAEe,aATV,yBAAAX,EAAAM,SAAAjB,KAaNgD,OAbMxC,EAAAC,EAAA0B,KAAA,SAAAa,EAaCC,EAbDC,GAAA,OAAA1C,EAAAC,EAAAC,KAAA,SAAAyC,GAAA,cAAAA,EAAAvC,KAAAuC,EAAAtC,MAAA,OAAAqC,EAaMX,IAbN,wBAAAY,EAAAlC,SAAA+B,MAgBTI,SAAU,CACRC,aADQ,SACKjC,EADLkC,GACyB,IAAX/C,EAAW+C,EAAX/C,QACpB,OAAOgD,OAAAC,EAAA,EAAAD,CAAA,GACFnC,EADL,CAEEC,UAAU,EACVC,QAAS,GACTC,KAAMhB,KAGVkD,WATQ,SASGrC,EATHsC,GASuB,IAAXnD,EAAWmD,EAAXnD,QAClB,OAAOgD,OAAAC,EAAA,EAAAD,CAAA,GACFnC,EADL,CAEEC,UAAU,EACVC,QAASf,EAAQe","file":"static/js/55.6f2e4f56.chunk.js","sourcesContent":["import $$ from 'cmn-utils';\r\n\r\nexport async function login(payload) {\r\n  return $$.post('/user/login', payload);\r\n}","import { routerRedux } from 'dva/router';\r\nimport { login } from '../service';\r\nimport $$ from 'cmn-utils';\r\n\r\nexport default {\r\n  namespace: 'login',\r\n\r\n  state: {\r\n    loggedIn: false,\r\n    message: '',\r\n    user: {},\r\n  },\r\n\r\n  subscriptions: {\r\n    setup({ history, dispatch }) {\r\n      return history.listen(({ pathname }) => {\r\n        if (pathname.indexOf('/sign/login') !== -1) {\r\n          $$.removeStore('user');\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  effects: {\r\n    *login({ payload }, { call, put }) {\r\n      const { status, message, data } = yield call(login, payload);\r\n      if (status) {\r\n        $$.setStore('user', data);\r\n        yield put(routerRedux.replace('/'));\r\n      } else {\r\n        yield put({\r\n          type: 'loginError',\r\n          payload: { message }\r\n        });\r\n      }\r\n    },\r\n    *logout(_, { put }) {}\r\n  },\r\n\r\n  reducers: {\r\n    loginSuccess(state, { payload }) {\r\n      return {\r\n        ...state,\r\n        loggedIn: true,\r\n        message: '',\r\n        user: payload\r\n      };\r\n    },\r\n    loginError(state, { payload }) {\r\n      return {\r\n        ...state,\r\n        loggedIn: false,\r\n        message: payload.message\r\n      };\r\n    },\r\n  }\r\n};\r\n"],"sourceRoot":""}